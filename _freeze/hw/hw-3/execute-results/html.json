{
  "hash": "507ea593ddd69042a5f3516d50c5be31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: HW 3\nsubtitle: Inflation everywhere\ndescription: \"Due: Sun, Sep 28, 11:59 pm\"\ncategories: HW\nfilters:\n  - ../remove-fmt-skip.lua\ndraft: false\n---\n\n# Introduction\n\nThis is a two-part homework assignment:\n\n- **Part 1 -- ü§ñ Feedback from AI:** Not graded, for practice, you get immediate feedback with AI, based on rubrics designed by the course instructor. Complete in `hw-3-part-1.qmd`, no submission required.\n\n- **Part 2 -- üßëüèΩ‚Äçüè´ Feedback from Humans:** Graded, you get feedback from the course instructional team within a week. Complete in `hw-3-part-2.qmd`, submit on Gradescope.\n\nBy now you should be familiar with how to get started with a homework assignment by cloning the GitHub repo for the assignment.\n\n<details>\n<summary>Click to expand if you need a refresher on how to get started with a homework assignment.</summary>\n\n-   Go to <https://cmgr.oit.duke.edu/containers> and login with your Duke NetID and Password.\n-   Click `STA199` under My reservations to log into your container. You should now see the RStudio environment.\n-   Go to the course organization at [github.com/sta199-f25](https://github.com/sta199-f25) organization on GitHub.\n    Click on the repo with the prefix **hw-3**.\n    It contains the starter documents you need to complete the homework.\n-   Click on the green **CODE** button, select **Use SSH**.\n    Click on the clipboard icon to copy the repo URL.\n-   In RStudio, go to *File* ‚ûõ *New Project* ‚ûõ*Version Control* ‚ûõ *Git*.\n-   Copy and paste the URL of your assignment repo into the dialog box *Repository URL*. Again, please make sure to have *SSH* highlighted under *Clone* when you copy the address.\n-   Click *Create Project*, and the files from your GitHub repo will be displayed in the *Files* pane in RStudio.\n</details>\n\nBy now you should also be familiar with guidelines for formatting your code and plots as well as your Git and Gradescope workflow.\n\n<details>\n<summary>Click to expand if you need a refresher on assignment guidelines.</summary>\n### Code\n\nCode should follow the [tidyverse style](https://style.tidyverse.org/).\nParticularly,\n\n-   there should be spaces before and line breaks after each `+` when building a `ggplot`,\n-   there should also be spaces before and line breaks after each `|>` in a data transformation pipeline,\n-   code should be properly indented,\n-   there should be spaces around `=` signs and spaces after commas.\n\nAdditionally, all code should be visible in the PDF output, i.e., should not run off the page on the PDF.\nLong lines that run off the page should be split across multiple lines with line breaks.\n\n### Plots\n\n-   Plots should have an informative title and, if needed, also a subtitle.\n-   Axes and legends should be labeled with both the variable name and its units (if applicable).\n-   Careful consideration should be given to aesthetic choices.\n\n### Workflow\n\nContinuing to develop a sound workflow for reproducible data analysis is important as you complete the lab and other assignments in this course.\n\n-   You should have at least 3 commits with meaningful commit messages by the end of the assignment.\n-   Final versions of both your `.qmd` file and the rendered PDF should be pushed to GitHub.\n\n</details>\n\n\n# Part 1 -- Feedback from AI\n\nYour answers to the questions in this part should go in the file `hw-3-part-1.qmd`.\n\n## Instructions\n\nWrite your answer to each question in the appropriate section of the `hw-3-part-1.qmd` file.\nThen, highlight your answer to a question, click on _Addins > AIFEEDR > Get feedback_.\nIn the app that opens, select the appropriate homework number (3) and question number.\nThen click on _Get Feedback_.\nPlease be patient, feedback generation can take a few seconds. \nOnce you read the feedback, you can go back to your Quarto document to improve your answer based on the feedback. \nYou will then need to click the red X on the top left corner of the Viewer pane to stop the feedback app from running before you can re-render your Quarto document.\n\n<details>\n<summary>Click to expand if you want to review the video that demonstrates how to use the AI feedback tool.</summary>\n{{< video https://www.youtube.com/embed/EyT6QQN1ouQ?si=DsG-laE30BykMJby title=\"aifeedr\">}}\n</details>\n\n## Packages\n\nIn this part you will work with the **tidyverse** package, which is a collection of packages for doing data analysis in a \"tidy\" way.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Data\n\nFor this part of the analysis you will work with inflation data from various countries in the world over 30 years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountry_inflation <- read_csv(\"data/country-inflation.csv\")\n```\n:::\n\n\n## Questions\n\n::: render-commit-push\nDo not forget to render, commit, and push regularly, after each substantial change to your document (e.g., after answering each question).\nUse succinct and informative commit messages.\nMake sure to commit and push all changed files so that your Git pane is empty afterward.\n:::\n\n### Question 1\n\nGet to know the data.\n\na.  `glimpse()` at the `country_inflation` data frame and answer the following questions based on the output. \n    - How many rows does `country_inflation` have and what does each row represent? \n    - How many columns does `country_inflation` have and what does each column represent?\n\nb.  Display the names of the countries included in the dataset. How many distinct countries are there?\n\n::: callout-tip\nFind distinct countries with `distinct()` and print all countries with `print_n(n = ___)` added to your pipeline, where the blank is the number of distinct countries.\n:::\n\n### Question 2\n\nWhich countries had the top three highest inflation rates in 2023? Your output should be a data frame with two columns, `country` and `2023`, with inflation rates in descending order, and three rows for the top three countries. Briefly comment on how the inflation rates for these countries compare to the inflation rate for United States in that year.\n\n::: callout-tip\nColumn names that are numbers are not considered \"proper\" in R, therefore to select them you‚Äôll need to surround them with backticks `(`).\n:::\n\n### Question 3\n\nIn a single pipeline,\n\n-   calculate the ratio of the inflation in 2023 and inflation in 1993 for each country and store this information in a new column called `inf_ratio`,\n-   select the variables `country` and `inf_ratio`, and\n-   store the result in a new data frame called `country_inflation_ratios`.\n\nThen, in two separate pipelines,\n\n-   arrange `country_inflation_ratios` in increasing order of `inf_ratio` and\n-   arrange `country_inflation_ratios` in decreasing order of `inf_ratio`.\n\nWhich country‚Äôs inflation increase is the largest over this time period and by how much?\nWhich country‚Äôs inflation decrease is the largest over this time period and by how much?\n\n::: callout-tip\nFor this question you'll once again need to use variables whose names are numbers (years) in your pipeline.\nMake sure to surround the names of such variables with backticks (`` ` ``).\n:::\n\n### Question 4\n\nReshape (pivot) `country_inflation` such that each row represents a country/year combination.\nThen, display the resulting data frame and state how many rows and columns it has and write a sentence stating the number of rows and columns as well as the names of the columns of the resulting data frame.\n\nRequirements:\n\n-   Your code must use one of `pivot_longer()` or `pivot_wider()`. There are other ways you can do this reshaping move in R, but this question requires solving this problem by pivoting.\n-   In your `pivot_*()` function, you must use `names_transform = as.numeric` as an argument to transform the variable type to numeric as you pivot the data so that in the resulting data frame the year variable is numeric.\n-   The resulting data frame must be saved as something other than `country_inflation` so you (1) can refer to this data frame later in your analysis and (2) do not overwrite `country_inflation`. Use a short but informative name.\n\n::: callout-warning\nThe last question in Part 1 as well as some questions in Part 2 require the use of the pivoted data frame from Question 4.\n:::\n\n### Question 5\n\nUse a separate, single pipeline to answer each of the following questions.\n\nRequirement: Your code must use the `filter()` function for each part, not `arrange()`.\n\na.  What is the highest inflation rate observed between 1993 and 2023?\n    The output of the pipeline should be a data frame with one row and three columns.\n    In addition to code and output, your response should include a single sentence stating the country and year.\n\nb.  What is the lowest inflation rate observed between 1993 and 2023?\n    The output of the pipeline should be a data frame with one row and three columns.\n    In addition to code and output, your response should include a single sentence stating the country and year.\n\nc.  Putting (a) and (b) together: What are the highest and the lowest inflation rates observed between 1993 and 2023?\n    The output of the pipeline should be a data frame with two rows and three columns.\n\n::: {.callout-important title=\"STOP: You must do this before proceeding to Part 2\"}\nAt the end of your Part 1 Quarto file you'll see a code cell like the following:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\n#| eval: false\nwrite_csv(_____, file = \"data/country-inflation-pivoted.csv\")\n```\n````\n:::\n\n\nThis will allow you to save the pivoted data frame from Question 4 as a CSV (comma-separated-values) file called `country-inflation-pivoted.csv` in your `data` folder so that you can read it and use it Part 2.\n\nYou need to modify the code cell by doing the following two things:\n\n1. **fill in the blank** with the name of the pivoted data frame from Question 4 and \n2. **change the value of the code cell option*** `eval` from `false` to `true` so that the code cell will run and save the CSV file when you render your Quarto document.\n\n:::\n\n::: render-commit-push\nNow is another good time to render, commit, and push your changes to GitHub with an informative and concise commit message.\nAnd once again, make sure to commit and push all changed files **including the newly created dataset** so that your Git pane is empty afterward.\nWe keep repeating this because it's important and because we see students forget to do this.\nSo take a moment to make sure you're practicing good version control habits.\n:::\n\n# Part 2 -- Feedback from Humans\n\nYour answers to the questions in this part should go in the file `hw-3-part-2.qmd`.\n\n## Packages\n\nYou will use the **tidyverse** package for data wrangling and visualization, \n\nYou may choose to load other packages as needed, particularly for improving your plots. \nIf you do so, add the functions to load these packages in the code cell labeled `load-packages`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Question 6\n\n**More on inflation around the world.**\n\nFor this question you will use the pivoted version of the `country_inflation` dataset that you created in Question 4 of Part 1.\nLoad this dataset from the CSV file you created at the end of Part 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountry_inflation_pivoted <- read_csv(\"data/country-inflation-pivoted.csv\")\n```\n:::\n\n\na\\.\nCreate a vector called `countries_of_interest` which contains the names of up to five countries you want to visualize the inflation rates for over the years.\nFor example, if these countries are T√ºrkiye and United States, you can express this as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncountries_of_interest <- c(\"T√ºrkiye\", \"United States\")\n```\n:::\n\n\nIf they are T√ºrkiye, United States, and Chile, you can express this as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fmt: skip\ncountries_of_interest <- c(\"T√ºrkiye\", \"United States\", \"Chile\")\n```\n:::\n\n\nSo on and so forth...\nThen, in 1-2 sentences, state why you chose these countries.\n\n::: callout-note\nYour `countries_of_interest` should consist of no more than five countries.\nMake sure that the spelling of your countries matches how they appear in the dataset.\n:::\n\nb\\.\nIn a single pipeline, filter your pivoted dataset to include only the `countries_of_interest` from part (a), and save the resulting data frame with a new name so you (1) can refer to this data frame later in your analysis and (2) do not overwrite the data frame you're starting with.\nUse a short but informative name.\nThen, in a new pipeline, find the `distinct()` countries in the data frame you created.\n\n::: callout-tip\nThe number of distinct countries in the filtered data frame you created in part (b) should equal the number of countries you chose in part (a).\nIf it doesn't, you might have misspelled a country name or made a mistake in filtering for these countries.\nGo back and correct your work.\n:::\n\nc\\.\nUsing your data frame from the previous question, create a plot of annual inflation vs. year for these countries.\nThen, in a few sentences, describe the patterns you observe in the plot, particularly focusing on anything you find surprising or not surprising, based on your knowledge (or lack thereof) of these countries economies.\n\nRequirements for the plot:\n\n-   Data should be represented with points as well as lines connecting the points for each country.\n-   Each country should be represented by a different color line and different color and shape points.\n-   Axes and legend should be properly labeled.\n-   The plot should have an appropriate title (and optionally a subtitle).\n-   Plot should be customized in at least one way ‚Äì you could use a different than default color scale, or different than default theme, or some other customization.\n\n::: render-commit-push\nDo not forget to render, commit, and push regularly, after each substantial change to your document (e.g., after answering each question).\nUse succinct and informative commit messages.\nMake sure to commit and push all changed files so that your Git pane is empty afterward.\n:::\n\n## Questions 7-9\n\n**Inflation in the US.**\n\nThe OECD defines inflation as follows:\n\n> Inflation is a rise in the general level of prices of goods and services that households acquire for the purpose of consumption in an economy over a period of time.\n>\n> The main measure of inflation is the annual inflation rate which is the movement of the Consumer Price Index (CPI) from one month/period to the same month/period of the previous year expressed as percentage over time.\n>\n> Source: [OECD CPI FAQ](https://www.oecd.org/sdd/prices-ppp/consumerpriceindices-frequentlyaskedquestionsfaqs.htm#1)\n\nCPI is broken down into 12 expenditures such as food, housing, health, etc.\nYour goal in this part is to create another time series plot of annual inflation, this time for US only.\n\nThe data you will need to create this visualization is spread across two files:\n\n-   `us-inflation.csv`: Annual inflation rate for the US for 12 CPI expenditures. Each expenditure is identified by an ID number.\n-   `cpi-expenditures.csv`: A \"lookup table\" of CPI expenditure ID numbers and their descriptions.\n\nLet's load both of these files.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_inflation <- read_csv(\"data/us-inflation.csv\")\ncpi_expenditures <- read_csv(\"data/cpi-expenditures.csv\")\n```\n:::\n\n\n### Question 7\n\na\\.\nHow many columns and how many rows does the `us_inflation` dataset have?\nWhat are the variables in it?\nWhich years do these data span?\nWrite a brief (1-2 sentences) narrative summarizing this information.\n\nb\\.\nHow many columns and how many rows does the `cpi_expenditures` dataset have?\nWhat are the variables in it?\nWrite a brief (1-2 sentences) narrative summarizing this information.\n\nc\\.\nCreate a new dataset by joining the `us_inflation` dataset with the `cpi_expenditure_id` dataset.\n\n-   Determine which type of join is the most appropriate one and use that.\n\n-   Note that the two datasets don't have a variable with a common name, though they do have variables that contain common information but are named differently.\n    You will need to first figure out which variables those are, and then define the `by` argument and use the `join_by()` function to indicate these variables to join the datasets by.\n\n-   Use a short but informative name for the joined dataset, and do not overwrite either of the datasets that go into creating it.\n\nThen, find the number of rows and columns of the resulting dataset and report the names of its columns.\nAdd a brief (1-2 sentences) narrative summarizing this information.\n\n### Question 8\n\na\\.\nCreate a vector called `expenditures_of_interest` which contains the descriptions or IDs of CPI expenditures you want to visualize.\nYour `expenditures_of_interest` should consist of no more than five expenditures.\nIf you're using descriptions, make sure that the spelling of your expenditures matches how they appear in the dataset.\nThen, in 1-2 sentences, state why you chose these expenditures.\n\n::: callout-tip\nRefer back to the guidance provided in [Question 6] if you're not sure how to create this vector.\n:::\n\nb\\.\nIn a single pipeline, filter your joined dataset to include only the `expenditures_of_interest` from part (a), and save the resulting data frame with a new name so you (1) can refer to this data frame later in your analysis and (2) do not overwrite the data frame you're starting with.\nUse a short but informative name.\nThen, in a new pipeline, find the `distinct()` expenditures in the data frame you created.\n\n### Question 9\n\nUsing your data frame from the previous question, create a plot of annual inflation vs. year for these expenditures.\nThen, in a few sentences, describe the patterns you observe in the plot, particularly focusing on anything you find surprising or not surprising, based on your knowledge (or lack thereof) of inflation rates in the US over the last decade.\n\nRequirements for the plot:\n\n-   Data should be represented with points as well as lines connecting the points for each expenditure.\n-   Each expenditure should be represented by a different color line and different color and shape points.\n-   Axes and legend should be properly labeled.\n-   The plot should have an appropriate title (and optionally a subtitle).\n-   Plot should be customized in at least one way ‚Äì you could use a different than default color scale, or different than default theme, or some other customization.\n-   If your legend has labels that are too long, you can try moving the legend to the bottom and stack the labels vertically. *Hint:* The `legend.position` and `legend.direction` arguments of the `theme()` functions will be useful.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(...) +\n  ... +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"vertical\"\n  )\n```\n:::\n\n\n## Question 10\n\n**Handling missing values after joins.**\n\nIn class last week, we worked with the `sales_taxes` dataset and joined it to another dataset called `us_regions` so that we ended up with a data frame containing information on each state (plus DC), salex tax rate in that state, and the region the state is in. While DC was in our first dataset, it was not in the second, resulting in an `NA` value for the `region` variable in the joined dataset. We discussed that there are three approaches we could take to address this issue before calculating the average average sales tax of states in each region.\n\na\\.\nRead in the two datasets, `sales-taxes-25.csv` and `us-regions.csv`, which are both in your `data` folder.\nThen, join the two datasets using the appropriate type of join to be able to calculate the average sales tax rate by region, not overwriting either data frame that goes into the join.\n\nb\\. \nApply the three approaches we discussed in class to address the issue that DC has an `NA` value for `region` in the joined dataset, and then calculate the average average sales tax of states in each region.\n\nc\\.\nChoose one of the three approaches as the \"most appropriate\" approach and provide a brief (1-2 sentences) rationale for your choice.\n\n::: callout-tip\nYou can refer back to [AE 06: Sales taxes + data joining](ae/ae-06-taxes-join-A.qmd) if you need a reminder of these data and how to join them.\n:::\n\n# Wrap-up\n\n::: callout-warning\nBefore you wrap up the assignment, make sure that you render, commit, and push one final time so that the final versions of both your `.qmd` file and the rendered PDF are pushed to GitHub and your Git pane is empty.\nWe will be checking these to make sure you have been practicing how to commit and push changes.\n:::\n\n## Submission\n\nSubmit your PDF document to Gradescope by the deadline to be considered \"on time\":\n\n-   Go to <http://www.gradescope.com> and click *Log in* in the top right corner.\n-   Click *School Credentials* $\\rightarrow$ *Duke NetID* and log in using your NetID credentials.\n-   Click on your *STA 199* course.\n-   Click on the assignment, and you'll be prompted to submit it.\n-   Mark all the pages associated with question. All the pages of your homework should be associated with at least one question (i.e., should be \"checked\").\n\n::: callout-important\n## Checklist\n\nMake sure you have:\n\n-   attempted all questions\n-   rendered your Quarto document\n-   committed and pushed everything to your GitHub repository such that the Git pane in RStudio is empty\n-   uploaded your PDF to Gradescope\n:::\n\n\n## Grading and feedback\n\n-   Questions 1-5 are not graded, but you should complete them to get practice.\n\n-   Questions 6-10 are graded, and you will receive feedback on Gradescope from the course instructional team within a week.\n    -   Questions will be graded for accuracy and completeness.\n    -   Partial credit will be given where appropriate.\n    -   There are also workflow points for:\n        - committing at least three times as you work through your lab,\n        - having your final version of `.qmd` and `.pdf` files in your GitHub repository, and\n        - overall organization.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}