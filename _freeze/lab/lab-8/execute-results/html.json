{
  "hash": "39a029f7bb5fe15dedf1d12290ec84b9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Lab 8\nsubtitle: \"Leavin' on a jet plane, hypothetically\"\ndescription: \"Due: End of lab on Mon, Nov 24\"\ncategories: Lab\nfilters:\n  - ../remove-fmt-skip.lua\ndraft: true\nexecute:\n  echo: true\n  eval: true\n  message: false\nfig-width: 6\nfig-asp: 0.618\n---\n\n# Introduction\n\nLast week you explored the relationship between distance and air time of flights out of RDU in 2024.\nAnd you did it in some *la la land* where we you had access to the full population.\nTime to get back to reality!\nThis week you will explore the same relationship, but this time you will work with a single sample from the population.\n\n## Getting started\n\nBy now you should be familiar with how to get started with a lab assignment by cloning the GitHub repo for the assignment.\nIf you're not sure how, refer back to an earlier lab.\n\nOpen the *lab-8.qmd* template Quarto file and update the `authors` field to add your name first (first and last) and then your teammates' names (first and last).\nRender the document.\nExamine the rendered document and make sure your and your teammates' names are updated in the document.\nCommit and push your changes with a meaningful commit message and push to GitHub.\n\n<details>\n\n<summary>Click to expand if you need a refresher on assignment guidelines.</summary>\n\n### Code\n\nCode should follow the [tidyverse style](https://style.tidyverse.org/).\nParticularly,\n\n-   there should be spaces before and line breaks after each `+` when building a `ggplot`,\n-   there should also be spaces before and line breaks after each `|>` in a data transformation pipeline,\n-   code should be properly indented,\n-   there should be spaces around `=` signs and spaces after commas.\n\nAdditionally, all code should be visible in the PDF output, i.e., should not run off the page on the PDF.\nLong lines that run off the page should be split across multiple lines with line breaks.[^1]\n\n[^1]: Remember, haikus not novellas when writing code!\n\n### Plots\n\n-   Plots should have an informative title and, if needed, also a subtitle.\n-   Axes and legends should be labeled with both the variable name and its units (if applicable).\n-   Careful consideration should be given to aesthetic choices.\n\n### Workflow\n\nContinuing to develop a sound workflow for reproducible data analysis is important as you complete the lab and other assignments in this course.\n\n-   You should have at least 3 commits with meaningful commit messages by the end of the assignment.\n-   Final versions of both your `.qmd` file and the rendered PDF should be pushed to GitHub.\n\n\n</details>\n\n## Packages\n\nIn this lab we will work with the **tidyverse** package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## Population data\n\nThe dataset, called `rdu-flights-sample.csv`, can be found in the `data` folder.\n\n# Questions\n\n## Part 1 - Observe\n\n## Question 1 - Read the observed data\n\nRead in your random sample of 100 flights and store it as `rdu_flights_sample`.\nEach person in the class will have the same observed sample of flights.\n\n::: {.callout-warning title=\"Suggested answer\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrdu_flights_sample <- read_csv(\"data/rdu-flights-sample.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 10 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (3): flight_id, distance, air_time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n:::\n\n### Question 2 - Visualize the observed relationship\n\nVisualize the relationship between `distance` and `air_time` using a scatter plot.\nAlso add a regression line to the scatter plot.\nDo not show the standard error ribbon around the regression line.\n\n::: {.callout-warning title=\"Suggested answer\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(rdu_flights_sample, aes(x = distance, y = air_time)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(\n    title = \"Scatter plot of air time vs. distance\",\n    x = \"Distance (miles)\",\n    y = \"Air time (minutes)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-8_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\n:::\n\n## Question 3 - Model and estimate the observed relationship\n\nFit a model predicting `air_time` using `distance` using the sample data.\nDisplay the model summary.\n\n::: {.callout-warning title=\"Suggested answer\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nair_time_dist_fit <- linear_reg() |>\n  fit(air_time ~ distance, data = rdu_flights_sample)\n\ntidy(air_time_dist_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   16.1     2.76         5.82 3.98e- 4\n2 distance       0.123   0.00277     44.5  7.20e-11\n```\n\n\n:::\n:::\n\n\n:::\n\n## Part 2 - Hypothesize\n\n## Question 4 - Set the null hypothesis\n\nWhat if there was no relationship between `distance` and `air_time`?\nWhat would the true slope of the relationship be in that case?\nThis is your null hypothesis.\nYou can articulate it as:\n\n$H_0:$ There is no relationship between distance and air time, the value of the true slope is \\_\\_\\_\\_, i.e., $\\beta_1$ = \\_\\_\\_\\_.\n\nFill in the blanks.\n\n::: callout-tip\nThe null hypothesis **always** sets the true population parameter **equal** to a specific value.\n:::\n\n::: {.callout-warning title=\"Suggested answer\"}\n$H_0:$ There is no relationship between distance and air time, the value of the true slope is 0, i.e., $\\beta_1$ = 0.\n:::\n\n## Question 5 - Set the alternative hypothesis\n\nWhat if there is a relationship between `distance` and `air_time`?\nThis is your alternative hypothesis!\n\n$H_A:$ There is a relationship between distance and air time, the value of the true slope is \\_\\_\\_\\_, i.e., $\\beta_1$ \\_\\_\\_\\_\\_\\_.\n\nFill in the blanks.\n\n::: callout-tip\nThe alternative hypothesis **always** compares the true population parameter to the same specific value set in the null hypothesis. \nThis comparison ca be \"not equal to\", \"greater than\", or \"less than\" and the choice depends on the research question.\nIn this case, our research question is whether there is *some* relationship between distance and air time.\n:::\n\n::: {.callout-warning title=\"Suggested answer\"}\n$H_A:$ There is a relationship between distance and air time, the value of the true slope is not equal to 0, i.e., $\\beta_1$ $\\ne$ 0.\n:::\n\n## Part 3 - Generate\n\n## Question 6 - Break the relationship\n\nNow let's set aside reality for a bit again, and imagine we live in the land of the null hypothesis where there is no relationship between `distance` and `air_time`.\nUsing the sample data, simulate such a world by breaking any relationship between `distance` and `air_time`.\nHow?\nRandomly permute the `air_time` values in your sample data to break any relationship between `distance` and `air_time`, and store the resulting air time values in a new column called `air_time_permuted`.\nEach person in the class should have a different permuation of the `air_time` values.\nYou could achieve this by setting different seeds, e.g., each person could use their birthday.\nMine is Feb 5, so I'll use `25`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(52)\nrdu_flights_sample <- rdu_flights_sample |>\n  mutate(\n    air_time_permuted = sample(\n      air_time,\n      size = nrow(rdu_flights_sample),\n      replace = FALSE\n    )\n  )\n```\n:::\n\n\nDisplay `rdu_flights_sample` to see the new column.\nConfirm that each `air_time_permuted` value comes from the original `air_time` values, but the order is different.\n\n::: {.callout-warning title=\"Suggested answer\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrdu_flights_sample\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 4\n   flight_id distance air_time air_time_permuted\n       <dbl>    <dbl>    <dbl>             <dbl>\n 1         1      130       37                92\n 2         2      612       92               192\n 3         3     1433      192                70\n 4         4     1042      142                39\n 5         5      227       39                52\n 6         6     2354      308               142\n 7         7      227       52                99\n 8         8      646       99                37\n 9         9      427       70               308\n10        10      416       56                56\n```\n\n\n:::\n:::\n\n\n:::\n\n## Question 7 - Visualize, model, and estimate the broken relationship\n\nVisualize the relationship between `distance` and `air_time` using a scatter plot.\nAlso add a regression line to the scatter plot.\nDo not show the standard error ribbon around the regression line.\n\nThen, fit a model predicting `air_time_permuted` using `distance` using the sample data.\nDisplay the model summary.\n\n::: {.callout-warning title=\"Suggested answer\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(rdu_flights_sample, aes(x = distance, y = air_time_permuted)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(\n    title = \"Scatter plot of permuted air time vs. distance\",\n    x = \"Distance (miles)\",\n    y = \"Permuted air time (minutes)\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](lab-8_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n\n```{.r .cell-code}\nair_time_perm_dist_fit <- linear_reg() |>\n  fit(air_time_permuted ~ distance, data = rdu_flights_sample)\n\ntidy(air_time_perm_dist_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term          estimate std.error statistic p.value\n  <chr>            <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept) 109.         43.6      2.49     0.0374\n2 distance      0.000209    0.0437   0.00479  0.996 \n```\n\n\n:::\n:::\n\n\n:::\n\nHow does the slope estimate for your permuted air time values compare to that of others in your team or others in the class?\nExactly the same? Wildly different? Somewhere in between?\n\n## Question 8 - Generate the null distribution (collectively)\n\nEach person in the class has now simulated a slightly different world where there is no relationship between `distance` and `air_time` by breaking any relationship in their sample data.\nMark your slope estimate from Question 7 on the number line on the board.\nThe distribution you constructed on the board is called the **null distribution** of the slope estimates.\nThis distribution represents what slope estimates we would expect to see if the null hypothesis were true.\n\nWhen everyone has marked their slope estimates, what does the overall distribution of slope estimates look like?\nIs it centered around a particular value?\n\n::: {.callout-warning title=\"Suggested answer\"}\n\nThe overall distribution of slope estimates looks approximately normal and is centered around 0.\n\n:::\n\n## Part 4 - Calculate and conclude\n\n## Question 9 - Calculate the p-value\n\nThe **p-value** is defined as the probability of the observed or more extreme outcomes assuming the null hypothesis is true.\nIn this case, the p-value is the probability, under the null distribution, of observing a slope estimate as extreme or more extreme than the one you observed in Question 3.\n\nBased on the null distribution you constructed collectively in Question 8, calculate your p-value.\n\n::: callout-tip\nFirst mark the slope estimate you observed in Question 3 on the number line on the board.\nThen count how many slope estimates in the null distribution are **beyond** your observed slope estimate.\nThen, don't forget about the other side of the distribution -- we generally account for that side by multiplying the count we obtained by 2.\nFinally, divide that count by the total number of slope estimates in the null distribution to get your p-value.\n:::\n\n::: {.callout-warning title=\"Suggested answer\"}\n\nAnswers will vary.\n\n:::\n\n## Question 10 - Conclude the hypothesis test\n\nUsing a significance level of $\\alpha = 0.05$, what is your conclusion regarding the hypothesis test you conducted?\n\n::: callout-tip\nIf your p-value is less than or equal to $\\alpha$, you reject the null hypothesis, and conclude that the data provide convincing evidence of a discernible relationship between distance and air time.\nIf your p-value is greater than $\\alpha$, you fail to reject the null hypothesis, and conclude that the data do not provide convincing evidence of a discernible relationship between distance and air time.\nWhatever you do, your conclusion should always be stated in the context of the research question.\n:::\n\n::: {.callout-warning title=\"Suggested answer\"}\n\nAnswers will vary.\n\n:::\n\n# Wrap-up\n\n::: callout-warning\nBefore you wrap up the assignment, make sure that you render, commit, and push one final time so that the final versions of both your `.qmd` file and the rendered PDF are pushed to GitHub and your Git pane is empty.\nWe will be checking these to make sure you have been practicing how to commit and push changes.\n:::\n\n## Submission\n\nBy now you should also be familiar with how to submit your assignment in Gradescope.\n\n<details>\n\n<summary>Click to expand if you need a refresher on how to get started with a lab assignment.</summary>\n\nSubmit your PDF document to Gradescope by the end of the lab to be considered \"on time\":\n\n-   Go to <http://www.gradescope.com> and click *Log in* in the top right corner.\n-   Click *School Credentials* $\\rightarrow$ *Duke NetID* and log in using your NetID credentials.\n-   Click on your *STA 199* course.\n-   Click on the assignment, and you'll be prompted to submit it.\n-   Mark all the pages associated with question. All the pages of your lab should be associated with at least one question (i.e., should be \"checked\").\n\n::: callout-important\n## Checklist\n\nMake sure you have:\n\n-   attempted all questions\n-   rendered your Quarto document\n-   committed and pushed everything to your GitHub repository such that the Git pane in RStudio is empty\n-   uploaded your PDF to Gradescope\n:::\n\n\n</details>\n\n## Grading and feedback\n\n-   This lab is worth 30 points:\n    -   10 points for being in lab and turning in *something* -- no partial credit for this part.\n    -   20 points for:\n        -   answering the questions correctly -- there is partial credit for this part.\n        -   following the workflow -- there is partial credit for this part.\n-   The workflow points are for:\n    -   committing at least three times as you work through your lab,\n    -   having your final version of `.qmd` and `.pdf` files in your GitHub repository, and\n    -   overall organization.\n-   You'll receive feedback on your lab on Gradescope within a week.\n\nGood luck, and have fun with it!\n",
    "supporting": [
      "lab-8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}