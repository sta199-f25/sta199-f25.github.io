{
  "hash": "773823e79ee9b0b88df944517260f687",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"AE 06: Sales taxes + data joining\"\nsubtitle: \"Suggested answers\"\ncategories: \n  - Application exercise\n  - Answers\n---\n\n::: callout-important\nThese are suggested answers.\nThis document should be used as a reference only; it's not designed to be an exhaustive key.\n:::\n\n## Getting started\n\n### Packages\n\nWe'll use the **tidyverse** package for this analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n### Data\n\nThe data are available in the `data` folder.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes <- read_csv(\"data/sales-taxes-25.csv\")\nus_regions <- read_csv(\"data/us-regions.csv\")\n```\n:::\n\n\nAnd let's take a look at the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(sales_taxes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 51\nColumns: 7\n$ state              <chr> \"Alabama\", \"Alaska\", \"Arizona\", \"Arkansas\", \"Califo…\n$ state_tax_rate     <dbl> 4.000, 0.000, 5.600, 6.500, 7.250, 2.900, 6.350, 0.…\n$ state_tax_rank     <dbl> 40, 46, 28, 9, 1, 45, 12, 46, 17, 40, 40, 17, 13, 2…\n$ avg_local_tax_rate <dbl> 5.44, 1.82, 2.92, 2.98, 1.73, 4.96, 0.00, 0.00, 1.0…\n$ max_local          <dbl> 11.000, 7.850, 5.300, 6.125, 5.250, 8.300, 0.000, 0…\n$ combined_tax_rate  <dbl> 9.44, 1.82, 8.52, 9.48, 8.98, 7.86, 6.35, 0.00, 7.0…\n$ combined_rank      <dbl> 5, 46, 11, 3, 7, 16, 33, 47, 24, 19, 45, 37, 8, 25,…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(us_regions)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 50\nColumns: 2\n$ state_name <chr> \"Maine\", \"New Hampshire\", \"Vermont\", \"Massachusetts\", \"Rhod…\n$ region     <chr> \"Northeast\", \"Northeast\", \"Northeast\", \"Northeast\", \"Northe…\n```\n\n\n:::\n:::\n\n\n## Joining\n\nJoin the sales tax data with region data and save the joined data frame as a new data frame, not overwriting either data frame that goes into the join.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions <- left_join(\n  sales_taxes,\n  us_regions,\n  by = join_by(state == state_name)\n)\n```\n:::\n\n\nCalculate the average sales tax of states in each region.\nWhat is surprising in the output?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 Midwest             5.69\n2 Northeast           5.30\n3 South               5.27\n4 West                4.16\n5 <NA>                6   \n```\n\n\n:::\n:::\n\n\nIdentify the state with `NA` for region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions |>\n  filter(is.na(region)) |>\n  select(state, region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n  state                region\n  <chr>                <chr> \n1 District of Columbia <NA>  \n```\n\n\n:::\n:::\n\n\nApply a fix for the `NA` in region, and calculate the mean sales taxes for regions again.\nDisplay the results in ascending order of mean sales tax.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsales_taxes_regions <- sales_taxes_regions |>\n  mutate(\n    region = if_else(state == \"District of Columbia\", \"Northeast\", region)\n  )\n\nsales_taxes_regions |>\n  group_by(region) |>\n  summarize(mean_state_tax = mean(state_tax_rate)) |>\n  arrange(mean_state_tax)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 2\n  region    mean_state_tax\n  <chr>              <dbl>\n1 West                4.16\n2 South               5.27\n3 Northeast           5.37\n4 Midwest             5.69\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "ae-06-taxes-join-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}